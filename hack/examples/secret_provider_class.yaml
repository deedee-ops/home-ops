---
# yaml-language-server: $schema=https://schemas.rzegocki.dev/secrets-store.csi.x-k8s.io/secretproviderclass_v1.json
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: cert-manager
spec:
  provider: vault
  secretObjects:
    - secretName: cloudflare-secret
      type: Opaque
      data:
        - objectName: CLOUDFLARE_API_TOKEN
          key: CLOUDFLARE_API_TOKEN
  parameters:
    objects: |
      - objectName: "CLOUDFLARE_API_TOKEN"
        secretPath: "kubernetes/data/external/cloudflare"
        secretKey: "API_TOKEN_CERT_MANAGER"
    roleName: cert-manager
    vaultAddress: https://vault.vault:8200
    vaultCACertPath: /vault/tls/tls.ca

---
# yamllint disable rule:line-length
# yaml-language-server: $schema=https://raw.githubusercontent.com/yannh/kubernetes-json-schema/master/master-standalone/secret-v1.json
# yamllint enable rule:line-length
apiVersion: v1
kind: Secret
metadata:
  name: hivemq-secret
type: Opaque
stringData:
  extension-config.xml: |
    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <extension-configuration>
        <credentials-reload-interval>60</credentials-reload-interval>
        <password-type>PLAIN</password-type>
    </extension-configuration>
  credentials.xml: |
    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <file-rbac>
        <users>
            <user>
                <name><path:kubernetes/data/internal/hivemq#MQTT_USERNAME></name>
                <password><path:kubernetes/data/internal/hivemq#MQTT_PASSWORD></password>
                <roles>
                    <id>superuser</id>
                </roles>
            </user>
        </users>
        <roles>
            <role>
                <id>superuser</id>
                <permissions>
                    <permission>
                        <topic>#</topic>
                    </permission>
                </permissions>
            </role>
        </roles>
    </file-rbac>

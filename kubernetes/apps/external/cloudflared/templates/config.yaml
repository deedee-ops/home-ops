---
# yamllint disable rule:line-length
# yaml-language-server: $schema=https://raw.githubusercontent.com/yannh/kubernetes-json-schema/master/master-standalone/configmap-v1.json
# yamllint enable rule:line-length
apiVersion: v1
kind: ConfigMap
metadata:
  name: cloudflared-configmap
data:
  config.yaml: |
    originRequest:
      http2Origin: true

    ingress:
      - hostname: "<path:kubernetes/data/internal/base#ROOT_DOMAIN>"
        service: https://nginx-external-controller.external.svc.cluster.local:443
        originRequest:
          originServerName: "external.<path:kubernetes/data/internal/base#ROOT_DOMAIN>"
      - hostname: "*.<path:kubernetes/data/internal/base#ROOT_DOMAIN>"
        service: https://nginx-external-controller.external.svc.cluster.local:443
        originRequest:
          originServerName: "external.<path:kubernetes/data/internal/base#ROOT_DOMAIN>"
      - service: http_status:404

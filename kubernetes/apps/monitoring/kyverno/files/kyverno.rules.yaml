---
# yaml-language-server: $schema=https://deedee-ops.github.io/schemas/custom/alertmanager-group.json
name: kyverno.rules
rules:
  - alert: KyvernoPolicyFailed
    expr: |
      increase(kyverno_policy_results_total{rule_result="fail",rule_execution_cause="background_scan"}[1m]) > 0
    for: 0m
    labels:
      severity: warning
    annotations:
      description: |
        Some kyverno policies are failing. Check `PolicyReport` resource across all namespaces, to see which ones.
      summary: Kyverno policies failing.

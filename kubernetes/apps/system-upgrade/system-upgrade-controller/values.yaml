---
# yaml-language-server: $schema=../../../../schemas/values.json
system-upgrade-controller:
  controllers:
    system-upgrade-controller:
      strategy: RollingUpdate
      replicas: 1
      containers:
        app:
          image:
            repository: docker.io/rancher/system-upgrade-controller
            tag: v0.17.0@sha256:7b334b59a48c1653c9f4f18016032255fd874916c78557bc671b7c7877642f1c
          env:
            SYSTEM_UPGRADE_CONTROLLER_LEADER_ELECT: true
            SYSTEM_UPGRADE_CONTROLLER_NAME: system-upgrade-controller
            SYSTEM_UPGRADE_CONTROLLER_NAMESPACE:
              valueFrom:
                fieldRef:
                  fieldPath: metadata.namespace
            SYSTEM_UPGRADE_CONTROLLER_NODE_NAME:
              valueFrom:
                fieldRef:
                  fieldPath: spec.nodeName
            SYSTEM_UPGRADE_JOB_BACKOFF_LIMIT: "99"
            SYSTEM_UPGRADE_JOB_PRIVILEGED: false
          securityContext:
            allowPrivilegeEscalation: false
            readOnlyRootFilesystem: true
            capabilities:
              drop:
                - "ALL"
      serviceAccount:
        identifier: system-upgrade-controller
  defaultPodOptions:
    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
      runAsGroup: 1000
      seccompProfile:
        type: RuntimeDefault
  serviceAccount:
    system-upgrade-controller: {}
